# Mall-Go ç¬¬ä¸‰å‘¨ç¼“å­˜ä¼˜åŒ–æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-01-10  
**é¡¹ç›®**: Mall-Go ç”µå•†ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–  
**é˜¶æ®µ**: ç¬¬ä¸‰å‘¨ - ç¼“å­˜ä¼˜åŒ–

## ğŸ“‹ **é¡¹ç›®èƒŒæ™¯**

### **ç¬¬äºŒå‘¨æˆæœå›é¡¾**

åŸºäºç¬¬äºŒå‘¨å¹¶å‘å®‰å…¨ä¼˜åŒ–çš„å®Œç¾æˆæœï¼š

- âœ… å¹¶å‘å®‰å…¨æ€§ï¼šå››å¤§æ ¸å¿ƒåœºæ™¯ 100%æˆåŠŸç‡
- âœ… æ€§èƒ½æŒ‡æ ‡ï¼šQPS 1000-2500ï¼Œç¨³å®šè¶…è¿‡åŸºå‡†
- âœ… ç³»ç»Ÿç¨³å®šæ€§ï¼š50 å¹¶å‘ç”¨æˆ·ä¸‹å®Œå…¨ç¨³å®š
- âœ… æ•°æ®ä¸€è‡´æ€§ï¼š100%ï¼Œé›¶è¶…å–ç°è±¡

### **ç¬¬ä¸‰å‘¨ä¼˜åŒ–ç›®æ ‡**

åœ¨ä¿æŒå¹¶å‘å®‰å…¨çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡ Redis ç¼“å­˜å±‚ä¼˜åŒ–ï¼š

- ğŸ¯ **æŸ¥è¯¢å“åº”æ—¶é—´**ï¼šä»å¹³å‡ 50ms é™ä½åˆ° 5ms ä»¥ä¸‹
- ğŸ¯ **ç¼“å­˜å‘½ä¸­ç‡**ï¼šæ ¸å¿ƒä¸šåŠ¡åœºæ™¯è¾¾åˆ° 90%ä»¥ä¸Š
- ğŸ¯ **ç³»ç»Ÿ QPS**ï¼šä» 2500 æå‡åˆ° 10000+
- ğŸ¯ **ç”¨æˆ·ä½“éªŒ**ï¼šé¡µé¢åŠ è½½æ—¶é—´å‡å°‘ 80%

## ğŸ—ï¸ **Redis ç¼“å­˜æ¶æ„è®¾è®¡**

### **1. ç¼“å­˜å±‚æ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web Layer     â”‚    â”‚   Cache Layer   â”‚    â”‚  Database Layer â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Controllers â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚ Redis Cache â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚   MySQL     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Services    â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚ Cache Mgr   â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚ GORM ORM    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2. ç¼“å­˜ç­–ç•¥è®¾è®¡**

#### **Cache-Aside æ¨¡å¼ï¼ˆä¸»è¦ç­–ç•¥ï¼‰**

```go
// è¯»å–æµç¨‹
func GetProduct(id uint) (*Product, error) {
    // 1. å…ˆæŸ¥ç¼“å­˜
    if product := cache.Get("product:" + id); product != nil {
        return product, nil
    }

    // 2. ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“
    product, err := db.GetProduct(id)
    if err != nil {
        return nil, err
    }

    // 3. å†™å…¥ç¼“å­˜
    cache.Set("product:" + id, product, 30*time.Minute)
    return product, nil
}

// æ›´æ–°æµç¨‹
func UpdateProduct(product *Product) error {
    // 1. æ›´æ–°æ•°æ®åº“
    err := db.UpdateProduct(product)
    if err != nil {
        return err
    }

    // 2. åˆ é™¤ç¼“å­˜ï¼ˆè®©ä¸‹æ¬¡è¯»å–æ—¶é‡æ–°åŠ è½½ï¼‰
    cache.Delete("product:" + product.ID)
    return nil
}
```

#### **Write-Through æ¨¡å¼ï¼ˆå…³é”®æ•°æ®ï¼‰**

```go
// ç”¨äºåº“å­˜ç­‰å…³é”®æ•°æ®ï¼Œç¡®ä¿å¼ºä¸€è‡´æ€§
func UpdateStock(productID uint, quantity int) error {
    // 1. åŒæ—¶æ›´æ–°æ•°æ®åº“å’Œç¼“å­˜
    err := db.UpdateStock(productID, quantity)
    if err != nil {
        return err
    }

    // 2. ç«‹å³æ›´æ–°ç¼“å­˜
    cache.Set("stock:" + productID, quantity, 10*time.Minute)
    return nil
}
```

### **3. æ•°æ®ç»“æ„è®¾è®¡**

#### **å•†å“ä¿¡æ¯ç¼“å­˜**

```go
// å•†å“åŸºç¡€ä¿¡æ¯ - Hashç»“æ„
Key: "product:{id}"
Fields: {
    "name": "å•†å“åç§°",
    "price": "99.99",
    "description": "å•†å“æè¿°",
    "category_id": "1",
    "status": "active",
    "created_at": "2025-01-10T10:00:00Z"
}
TTL: 30åˆ†é’Ÿ

// å•†å“åº“å­˜ - Stringç»“æ„ï¼ˆé«˜é¢‘æ›´æ–°ï¼‰
Key: "stock:{id}"
Value: "100"
TTL: 10åˆ†é’Ÿ

// å•†å“ä»·æ ¼ - Stringç»“æ„ï¼ˆå¯èƒ½é¢‘ç¹å˜åŠ¨ï¼‰
Key: "price:{id}"
Value: "99.99"
TTL: 15åˆ†é’Ÿ
```

#### **ç”¨æˆ·ä¼šè¯ç¼“å­˜**

```go
// ç”¨æˆ·ç™»å½•çŠ¶æ€ - Hashç»“æ„
Key: "user:session:{token}"
Fields: {
    "user_id": "123",
    "username": "user123",
    "role": "customer",
    "login_time": "2025-01-10T10:00:00Z",
    "last_active": "2025-01-10T10:30:00Z"
}
TTL: 2å°æ—¶

// è´­ç‰©è½¦æ•°æ® - Listç»“æ„
Key: "cart:{user_id}"
Value: [
    {"product_id": 1, "quantity": 2, "price": "99.99"},
    {"product_id": 2, "quantity": 1, "price": "199.99"}
]
TTL: 24å°æ—¶
```

#### **çƒ­ç‚¹æ•°æ®ç¼“å­˜**

```go
// çƒ­é—¨å•†å“åˆ—è¡¨ - ZSetç»“æ„ï¼ˆæŒ‰é”€é‡æ’åºï¼‰
Key: "hot:products"
Members: {
    "product:1": 1000,  // é”€é‡ä½œä¸ºscore
    "product:2": 800,
    "product:3": 600
}
TTL: 1å°æ—¶

// åˆ†ç±»å•†å“åˆ—è¡¨ - Listç»“æ„
Key: "category:{id}:products"
Value: ["product:1", "product:2", "product:3"]
TTL: 30åˆ†é’Ÿ
```

### **4. ç¼“å­˜é”®å‘½åè§„èŒƒ**

```go
// å‘½åè§„èŒƒ
const (
    // å•†å“ç›¸å…³
    ProductInfoKey    = "product:{id}"           // å•†å“åŸºç¡€ä¿¡æ¯
    ProductStockKey   = "stock:{id}"             // å•†å“åº“å­˜
    ProductPriceKey   = "price:{id}"             // å•†å“ä»·æ ¼

    // ç”¨æˆ·ç›¸å…³
    UserSessionKey    = "user:session:{token}"   // ç”¨æˆ·ä¼šè¯
    UserCartKey       = "cart:{user_id}"         // è´­ç‰©è½¦
    UserProfileKey    = "user:profile:{id}"      // ç”¨æˆ·èµ„æ–™

    // ä¸šåŠ¡ç›¸å…³
    CategoryProductsKey = "category:{id}:products" // åˆ†ç±»å•†å“
    HotProductsKey     = "hot:products"            // çƒ­é—¨å•†å“
    OrderKey          = "order:{id}"               // è®¢å•ä¿¡æ¯

    // ç»Ÿè®¡ç›¸å…³
    ProductViewKey    = "stats:view:{id}"        // å•†å“æµè§ˆé‡
    DailyStatsKey     = "stats:daily:{date}"     // æ—¥ç»Ÿè®¡
)
```

### **5. è¿‡æœŸç­–ç•¥è®¾è®¡**

#### **TTL è®¾ç½®ç­–ç•¥**

```go
var CacheTTL = map[string]time.Duration{
    // åŸºç¡€æ•°æ® - è¾ƒé•¿TTL
    "product":     30 * time.Minute,  // å•†å“ä¿¡æ¯
    "category":    60 * time.Minute,  // åˆ†ç±»ä¿¡æ¯
    "user":        120 * time.Minute, // ç”¨æˆ·èµ„æ–™

    // åŠ¨æ€æ•°æ® - è¾ƒçŸ­TTL
    "stock":       10 * time.Minute,  // åº“å­˜æ•°æ®
    "price":       15 * time.Minute,  // ä»·æ ¼ä¿¡æ¯
    "cart":        24 * time.Hour,    // è´­ç‰©è½¦

    // ä¼šè¯æ•°æ® - ä¸­ç­‰TTL
    "session":     2 * time.Hour,     // ç”¨æˆ·ä¼šè¯
    "token":       30 * time.Minute,  // è®¿é—®ä»¤ç‰Œ

    // ç»Ÿè®¡æ•°æ® - çŸ­TTL
    "stats":       5 * time.Minute,   // å®æ—¶ç»Ÿè®¡
    "hot":         60 * time.Minute,  // çƒ­ç‚¹æ•°æ®
}
```

#### **ç¼“å­˜é¢„çƒ­ç­–ç•¥**

```go
// ç³»ç»Ÿå¯åŠ¨æ—¶é¢„çƒ­å…³é”®æ•°æ®
func WarmupCache() error {
    // 1. é¢„çƒ­çƒ­é—¨å•†å“
    hotProducts, err := db.GetHotProducts(100)
    if err != nil {
        return err
    }
    for _, product := range hotProducts {
        cache.Set(ProductInfoKey(product.ID), product, CacheTTL["product"])
    }

    // 2. é¢„çƒ­åˆ†ç±»æ•°æ®
    categories, err := db.GetAllCategories()
    if err != nil {
        return err
    }
    for _, category := range categories {
        cache.Set(CategoryKey(category.ID), category, CacheTTL["category"])
    }

    return nil
}
```

## ğŸ”— **ä¸å¹¶å‘å®‰å…¨æœºåˆ¶é›†æˆ**

### **1. ä¹è§‚é”ä¸ç¼“å­˜ç»“åˆ**

```go
// åº“å­˜æ‰£å‡æ—¶çš„ç¼“å­˜æ›´æ–°
func DeductStockWithCache(productID uint, quantity int) error {
    // 1. ä½¿ç”¨ä¹è§‚é”æ›´æ–°æ•°æ®åº“ï¼ˆä¿æŒç¬¬äºŒå‘¨çš„å¹¶å‘å®‰å…¨æœºåˆ¶ï¼‰
    err := productService.DeductStockWithOptimisticLock(productID, quantity)
    if err != nil {
        return err
    }

    // 2. æ›´æ–°ç¼“å­˜ä¸­çš„åº“å­˜
    stockKey := fmt.Sprintf("stock:%d", productID)
    newStock, err := db.GetProductStock(productID)
    if err != nil {
        // ç¼“å­˜æ›´æ–°å¤±è´¥ä¸å½±å“ä¸»æµç¨‹ï¼Œè®°å½•æ—¥å¿—
        log.Errorf("Failed to update stock cache: %v", err)
        return nil
    }

    cache.Set(stockKey, newStock, CacheTTL["stock"])
    return nil
}
```

### **2. åˆ†å¸ƒå¼é”é˜²æ­¢ç¼“å­˜å‡»ç©¿**

```go
// é˜²æ­¢çƒ­ç‚¹æ•°æ®ç¼“å­˜å‡»ç©¿
func GetProductWithLock(id uint) (*Product, error) {
    cacheKey := fmt.Sprintf("product:%d", id)
    lockKey := fmt.Sprintf("lock:product:%d", id)

    // 1. å…ˆæŸ¥ç¼“å­˜
    if product := cache.Get(cacheKey); product != nil {
        return product, nil
    }

    // 2. è·å–åˆ†å¸ƒå¼é”
    lock, err := redis.SetNX(lockKey, "1", 10*time.Second)
    if err != nil || !lock {
        // è·å–é”å¤±è´¥ï¼Œç­‰å¾…åé‡è¯•
        time.Sleep(50 * time.Millisecond)
        return GetProductWithLock(id) // é€’å½’é‡è¯•
    }

    defer redis.Del(lockKey) // é‡Šæ”¾é”

    // 3. åŒé‡æ£€æŸ¥ç¼“å­˜
    if product := cache.Get(cacheKey); product != nil {
        return product, nil
    }

    // 4. æŸ¥è¯¢æ•°æ®åº“å¹¶æ›´æ–°ç¼“å­˜
    product, err := db.GetProduct(id)
    if err != nil {
        return nil, err
    }

    cache.Set(cacheKey, product, CacheTTL["product"])
    return product, nil
}
```

## ğŸ“Š **æ€§èƒ½ç›®æ ‡ä¸éªŒæ”¶æ ‡å‡†**

### **ç¬¬ä¸‰å‘¨éªŒæ”¶æ ‡å‡†**

| æŒ‡æ ‡             | å½“å‰å€¼ | ç›®æ ‡å€¼  | éªŒè¯æ–¹æ³• |
| ---------------- | ------ | ------- | -------- |
| å•†å“æŸ¥è¯¢å“åº”æ—¶é—´ | 50ms   | â‰¤5ms    | å‹åŠ›æµ‹è¯• |
| ç¼“å­˜å‘½ä¸­ç‡       | 0%     | â‰¥90%    | ç›‘æ§ç»Ÿè®¡ |
| ç³»ç»Ÿ QPS         | 2,500  | â‰¥10,000 | å¹¶å‘æµ‹è¯• |
| é¡µé¢åŠ è½½æ—¶é—´     | 500ms  | â‰¤100ms  | å‰ç«¯æµ‹è¯• |
| æ•°æ®åº“æŸ¥è¯¢å‡å°‘   | 0%     | â‰¥80%    | ç›‘æ§å¯¹æ¯” |

### **å…³é”®æ€§èƒ½æŒ‡æ ‡**

```go
type CacheMetrics struct {
    HitRate        float64 `json:"hit_rate"`        // ç¼“å­˜å‘½ä¸­ç‡
    MissRate       float64 `json:"miss_rate"`       // ç¼“å­˜æœªå‘½ä¸­ç‡
    AvgResponseTime time.Duration `json:"avg_response_time"` // å¹³å‡å“åº”æ—¶é—´
    QPS            int     `json:"qps"`             // æ¯ç§’æŸ¥è¯¢æ•°
    CacheSize      int64   `json:"cache_size"`      // ç¼“å­˜å¤§å°
    MemoryUsage    int64   `json:"memory_usage"`    // å†…å­˜ä½¿ç”¨é‡
}
```

## ğŸ› ï¸ **æŠ€æœ¯å®ç°è¦ç‚¹**

### **1. Redis è¿æ¥æ± é…ç½®**

```go
type RedisConfig struct {
    Host         string `yaml:"host"`
    Port         int    `yaml:"port"`
    Password     string `yaml:"password"`
    DB           int    `yaml:"db"`
    PoolSize     int    `yaml:"pool_size"`
    MinIdleConns int    `yaml:"min_idle_conns"`
    MaxRetries   int    `yaml:"max_retries"`
    DialTimeout  time.Duration `yaml:"dial_timeout"`
    ReadTimeout  time.Duration `yaml:"read_timeout"`
    WriteTimeout time.Duration `yaml:"write_timeout"`
}
```

### **2. ç¼“å­˜ç®¡ç†å™¨æ¥å£**

```go
type CacheManager interface {
    Get(key string) (interface{}, error)
    Set(key string, value interface{}, ttl time.Duration) error
    Delete(key string) error
    Exists(key string) bool
    Expire(key string, ttl time.Duration) error

    // æ‰¹é‡æ“ä½œ
    MGet(keys []string) ([]interface{}, error)
    MSet(pairs map[string]interface{}, ttl time.Duration) error

    // ç»Ÿè®¡ä¿¡æ¯
    GetMetrics() *CacheMetrics
}
```

### **3. ç¼“å­˜ä¸€è‡´æ€§ä¿è¯**

```go
// äº‹åŠ¡æ€§ç¼“å­˜æ›´æ–°
func UpdateProductWithCache(product *Product) error {
    // 1. å¼€å¯æ•°æ®åº“äº‹åŠ¡
    tx := db.Begin()
    defer func() {
        if r := recover(); r != nil {
            tx.Rollback()
        }
    }()

    // 2. æ›´æ–°æ•°æ®åº“
    if err := tx.UpdateProduct(product); err != nil {
        tx.Rollback()
        return err
    }

    // 3. æäº¤äº‹åŠ¡
    if err := tx.Commit(); err != nil {
        return err
    }

    // 4. æ›´æ–°ç¼“å­˜ï¼ˆå¼‚æ­¥ï¼Œå¤±è´¥ä¸å½±å“ä¸»æµç¨‹ï¼‰
    go func() {
        cacheKey := fmt.Sprintf("product:%d", product.ID)
        if err := cache.Set(cacheKey, product, CacheTTL["product"]); err != nil {
            log.Errorf("Failed to update cache: %v", err)
        }
    }()

    return nil
}
```

## ğŸ” **ç›‘æ§ä¸è¿ç»´**

### **1. ç¼“å­˜ç›‘æ§æŒ‡æ ‡**

- ç¼“å­˜å‘½ä¸­ç‡/æœªå‘½ä¸­ç‡
- å¹³å‡å“åº”æ—¶é—´
- QPS ç»Ÿè®¡
- å†…å­˜ä½¿ç”¨æƒ…å†µ
- è¿æ¥æ± çŠ¶æ€
- é”™è¯¯ç‡ç»Ÿè®¡

### **2. å‘Šè­¦ç­–ç•¥**

- ç¼“å­˜å‘½ä¸­ç‡ < 80%
- å“åº”æ—¶é—´ > 10ms
- å†…å­˜ä½¿ç”¨ç‡ > 80%
- è¿æ¥æ± è€—å°½
- é”™è¯¯ç‡ > 1%

### **3. è¿ç»´å·¥å…·**

- ç¼“å­˜æ•°æ®æŸ¥çœ‹å·¥å…·
- ç¼“å­˜æ¸…ç†å·¥å…·
- æ€§èƒ½åˆ†æå·¥å…·
- ç›‘æ§é¢æ¿

## ğŸ“ **è¯¦ç»†å¼€å‘è®¡åˆ’**

### **é˜¶æ®µ 1ï¼šRedis åŸºç¡€æ¶æ„æ­å»ºï¼ˆé¢„è®¡ 2 å¤©ï¼‰**

**ä»»åŠ¡ 1.1ï¼šRedis è¿æ¥é…ç½®å®ç°**

- éªŒæ”¶æ ‡å‡†ï¼šè¿æ¥æ± æ­£å¸¸å·¥ä½œï¼Œæ”¯æŒå¹¶å‘è¿æ¥
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šæ— 

**ä»»åŠ¡ 1.2ï¼šç¼“å­˜ç®¡ç†å™¨æ¥å£è®¾è®¡**

- éªŒæ”¶æ ‡å‡†ï¼šæ¥å£è®¾è®¡å®Œæ•´ï¼Œæ”¯æŒåŸºç¡€ CRUD å’Œæ‰¹é‡æ“ä½œ
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 1.1

**ä»»åŠ¡ 1.3ï¼šç¼“å­˜é”®ç®¡ç†å·¥å…·**

- éªŒæ”¶æ ‡å‡†ï¼šé”®å‘½åè§„èŒƒå®ç°ï¼ŒTTL ç®¡ç†æ­£å¸¸
- å®Œæˆæ—¶é—´ï¼š1 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 1.2

### **é˜¶æ®µ 2ï¼šå•†å“ä¿¡æ¯ç¼“å­˜å®ç°ï¼ˆé¢„è®¡ 3 å¤©ï¼‰**

**ä»»åŠ¡ 2.1ï¼šå•†å“åŸºç¡€ä¿¡æ¯ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šå•†å“è¯¦æƒ…ç¼“å­˜å‘½ä¸­ç‡>90%ï¼Œå“åº”æ—¶é—´<5ms
- å®Œæˆæ—¶é—´ï¼š1 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ–é˜¶æ®µ 1 å®Œæˆ

**ä»»åŠ¡ 2.2ï¼šå•†å“åº“å­˜ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šä¸ä¹è§‚é”æœºåˆ¶å®Œç¾é›†æˆï¼Œæ•°æ®ä¸€è‡´æ€§ 100%
- å®Œæˆæ—¶é—´ï¼š1 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 2.1ï¼Œéœ€è¦é›†æˆç¬¬äºŒå‘¨ä¹è§‚é”

**ä»»åŠ¡ 2.3ï¼šå•†å“ä»·æ ¼ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šä»·æ ¼æ›´æ–°å®æ—¶åŒæ­¥ï¼Œæ”¯æŒä¿ƒé”€ä»·æ ¼
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 2.2

**ä»»åŠ¡ 2.4ï¼šåˆ†ç±»å•†å“åˆ—è¡¨ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šåˆ†ç±»åˆ—è¡¨æŸ¥è¯¢å“åº”æ—¶é—´<3ms
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 2.3

### **é˜¶æ®µ 3ï¼šç”¨æˆ·ä¼šè¯ç¼“å­˜ä¼˜åŒ–ï¼ˆé¢„è®¡ 2 å¤©ï¼‰**

**ä»»åŠ¡ 3.1ï¼šç”¨æˆ·ç™»å½•çŠ¶æ€ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šJWT éªŒè¯å“åº”æ—¶é—´<2ms
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ–é˜¶æ®µ 2 å®Œæˆ

**ä»»åŠ¡ 3.2ï¼šè´­ç‰©è½¦æ•°æ®ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šè´­ç‰©è½¦æ“ä½œå“åº”æ—¶é—´<3msï¼Œæ•°æ®å®æ—¶åŒæ­¥
- å®Œæˆæ—¶é—´ï¼š1 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 3.1

**ä»»åŠ¡ 3.3ï¼šç”¨æˆ·åå¥½ç¼“å­˜**

- éªŒæ”¶æ ‡å‡†ï¼šä¸ªæ€§åŒ–æ¨èå“åº”æ—¶é—´<5ms
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 3.2

### **é˜¶æ®µ 4ï¼šç¼“å­˜ä¸€è‡´æ€§ä¸æ€§èƒ½ä¼˜åŒ–ï¼ˆé¢„è®¡ 2 å¤©ï¼‰**

**ä»»åŠ¡ 4.1ï¼šç¼“å­˜ä¸€è‡´æ€§æœºåˆ¶**

- éªŒæ”¶æ ‡å‡†ï¼šç¼“å­˜ä¸æ•°æ®åº“æ•°æ®ä¸€è‡´æ€§ 100%
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ–é˜¶æ®µ 3 å®Œæˆ

**ä»»åŠ¡ 4.2ï¼šç¼“å­˜é¢„çƒ­åŠŸèƒ½**

- éªŒæ”¶æ ‡å‡†ï¼šç³»ç»Ÿå¯åŠ¨åçƒ­ç‚¹æ•°æ®é¢„åŠ è½½å®Œæˆ
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 4.1

**ä»»åŠ¡ 4.3ï¼šé˜²ç¼“å­˜å‡»ç©¿æœºåˆ¶**

- éªŒæ”¶æ ‡å‡†ï¼šé«˜å¹¶å‘ä¸‹æ— ç¼“å­˜å‡»ç©¿ç°è±¡
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 4.2

**ä»»åŠ¡ 4.4ï¼šç¼“å­˜ç›‘æ§ä¸ç»Ÿè®¡**

- éªŒæ”¶æ ‡å‡†ï¼šå®æ—¶ç›‘æ§ç¼“å­˜å‘½ä¸­ç‡ã€å“åº”æ—¶é—´ç­‰æŒ‡æ ‡
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 4.3

### **é˜¶æ®µ 5ï¼šæ€§èƒ½æµ‹è¯•ä¸éªŒè¯ï¼ˆé¢„è®¡ 2 å¤©ï¼‰**

**ä»»åŠ¡ 5.1ï¼šç¼“å­˜åŠŸèƒ½æµ‹è¯•**

- éªŒæ”¶æ ‡å‡†ï¼šæ‰€æœ‰ç¼“å­˜åŠŸèƒ½æ­£å¸¸ï¼Œæ— æ•°æ®ä¸¢å¤±
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ–é˜¶æ®µ 4 å®Œæˆ

**ä»»åŠ¡ 5.2ï¼šç¼“å­˜æ€§èƒ½æµ‹è¯•**

- éªŒæ”¶æ ‡å‡†ï¼šè¾¾åˆ°æ‰€æœ‰æ€§èƒ½ç›®æ ‡æŒ‡æ ‡
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 5.1

**ä»»åŠ¡ 5.3ï¼šå¹¶å‘å®‰å…¨éªŒè¯**

- éªŒæ”¶æ ‡å‡†ï¼šç¼“å­˜ä¸ç¬¬äºŒå‘¨ä¹è§‚é”æœºåˆ¶å®Œç¾é›†æˆ
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 5.2

**ä»»åŠ¡ 5.4ï¼šå‹åŠ›æµ‹è¯•éªŒè¯**

- éªŒæ”¶æ ‡å‡†ï¼šç³»ç»Ÿ QPS è¾¾åˆ° 10000+ï¼Œå“åº”æ—¶é—´<5ms
- å®Œæˆæ—¶é—´ï¼š0.5 å¤©
- ä¾èµ–å…³ç³»ï¼šä¾èµ– 5.3

### **ğŸ“Š ç¬¬ä¸‰å‘¨å…·ä½“ç›®æ ‡**

**åŸºäºç¬¬äºŒå‘¨ 100%éªŒæ”¶æ ‡å‡†è¾¾æ ‡çš„åŸºç¡€ä¸Šï¼š**

| æ€§èƒ½æŒ‡æ ‡         | ç¬¬äºŒå‘¨åŸºçº¿ | ç¬¬ä¸‰å‘¨ç›®æ ‡ | æå‡å¹…åº¦ | éªŒè¯æ–¹æ³•           |
| ---------------- | ---------- | ---------- | -------- | ------------------ |
| å•†å“æŸ¥è¯¢å“åº”æ—¶é—´ | 50ms       | â‰¤5ms       | 90%â†“     | å‹åŠ›æµ‹è¯• 1000 å¹¶å‘ |
| ç¼“å­˜å‘½ä¸­ç‡       | 0%         | â‰¥90%       | +90%     | ç›‘æ§ç»Ÿè®¡ 24 å°æ—¶   |
| ç³»ç»Ÿ QPS         | 2,500      | â‰¥10,000    | 300%â†‘    | å¹¶å‘æµ‹è¯•éªŒè¯       |
| é¡µé¢åŠ è½½æ—¶é—´     | 500ms      | â‰¤100ms     | 80%â†“     | å‰ç«¯æ€§èƒ½æµ‹è¯•       |
| æ•°æ®åº“æŸ¥è¯¢å‡å°‘   | 0%         | â‰¥80%       | +80%     | ç›‘æ§å¯¹æ¯”åˆ†æ       |
| å†…å­˜ä½¿ç”¨æ•ˆç‡     | -          | â‰¤512MB     | -        | Redis ç›‘æ§         |

### **ğŸ¯ å…³é”®é‡Œç¨‹ç¢‘**

**é‡Œç¨‹ç¢‘ 1ï¼ˆç¬¬ 2 å¤©ï¼‰**ï¼šåŸºç¡€æ¶æ„å®Œæˆ

- Redis è¿æ¥æ± æ­£å¸¸å·¥ä½œ
- ç¼“å­˜ç®¡ç†å™¨æ¥å£å®ç°
- åŸºç¡€å·¥å…·ç±»å¼€å‘å®Œæˆ

**é‡Œç¨‹ç¢‘ 2ï¼ˆç¬¬ 5 å¤©ï¼‰**ï¼šæ ¸å¿ƒç¼“å­˜åŠŸèƒ½å®Œæˆ

- å•†å“ä¿¡æ¯ç¼“å­˜å®ç°
- ç”¨æˆ·ä¼šè¯ç¼“å­˜å®ç°
- åŸºç¡€æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡

**é‡Œç¨‹ç¢‘ 3ï¼ˆç¬¬ 7 å¤©ï¼‰**ï¼šé«˜çº§åŠŸèƒ½å®Œæˆ

- ç¼“å­˜ä¸€è‡´æ€§æœºåˆ¶å®ç°
- é˜²å‡»ç©¿æœºåˆ¶å®ç°
- ç›‘æ§ç³»ç»Ÿå®Œå–„

**é‡Œç¨‹ç¢‘ 4ï¼ˆç¬¬ 9 å¤©ï¼‰**ï¼šæ€§èƒ½éªŒè¯å®Œæˆ

- æ‰€æœ‰éªŒæ”¶æ ‡å‡†è¾¾æ ‡
- å‹åŠ›æµ‹è¯•é€šè¿‡
- ç³»ç»Ÿæ•´ä½“æ€§èƒ½æå‡éªŒè¯

### **ğŸ”„ ä¸ç¬¬äºŒå‘¨é›†æˆè¦ç‚¹**

1. **ä¹è§‚é”æœºåˆ¶ä¿æŒ**ï¼šç¼“å­˜å±‚ä¸å½±å“ç¬¬äºŒå‘¨çš„å¹¶å‘å®‰å…¨æœºåˆ¶
2. **æ•°æ®ä¸€è‡´æ€§**ï¼šç¼“å­˜æ›´æ–°ä¸ä¹è§‚é”æ›´æ–°åŒæ­¥è¿›è¡Œ
3. **æ€§èƒ½å åŠ **ï¼šç¼“å­˜ä¼˜åŒ– + å¹¶å‘å®‰å…¨ = åŒé‡æ€§èƒ½æå‡
4. **æµ‹è¯•å…¼å®¹**ï¼šç¬¬äºŒå‘¨çš„å¹¶å‘æµ‹è¯•æ¡†æ¶ç»§ç»­æœ‰æ•ˆ

**æ€»è®¡ï¼š9 å¤©å®Œæˆï¼Œæ¯”åŸè®¡åˆ’æå‰ 3 å¤©**

---

**æ–‡æ¡£çŠ¶æ€**: âœ… å·²å®Œæˆ
**ä¸‹ä¸€æ­¥**: ç­‰å¾…ç¡®è®¤åå¼€å§‹é˜¶æ®µ 1 å¼€å‘å·¥ä½œ
