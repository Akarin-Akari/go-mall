# Casbin RBAC权限模型配置文件
# 适用于Mall-Go商城系统的角色权限管理

[request_definition]
# 请求定义：主体(subject)、对象(object)、动作(action)
r = sub, obj, act

[policy_definition]
# 策略定义：主体、对象、动作
p = sub, obj, act

[role_definition]
# 角色定义：用户和角色的继承关系
g = _, _

[policy_effect]
# 策略效果：如果存在任何允许的策略，则允许
e = some(where (p.eft == allow))

[matchers]
# 匹配器：检查用户角色是否有权限执行操作
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act

# 权限模型说明：
# 1. 用户通过角色获得权限
# 2. 支持角色继承（如管理员继承商家权限）
# 3. 基于资源和操作的细粒度权限控制
# 4. 支持动态权限分配和撤销

# 示例权限规则：
# p, admin, user, manage     # 管理员可以管理用户
# p, admin, product, manage  # 管理员可以管理商品
# p, admin, order, manage    # 管理员可以管理订单
# p, merchant, product, write # 商家可以编辑商品
# p, merchant, order, read   # 商家可以查看订单
# p, user, order, read       # 用户可以查看自己的订单
# g, alice, admin            # alice用户是管理员
# g, bob, merchant           # bob用户是商家
