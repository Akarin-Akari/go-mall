# Mall-Go å‰ç«¯å¼€å‘æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**åç«¯APIåœ°å€**: http://localhost:8080  
**é¡¹ç›®å®Œæˆåº¦**: 91%  
**æ ¸å¿ƒåŠŸèƒ½**: å®Œå…¨å°±ç»ª  
**è®¤è¯æ–¹å¼**: JWT Token  
**æ•°æ®æ ¼å¼**: JSON  

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼š
```bash
cd mall-go
go run cmd/server/main.go
```

éªŒè¯æœåŠ¡çŠ¶æ€ï¼š
```bash
curl http://localhost:8080/health
# é¢„æœŸå“åº”: {"message":"Mall Go API is running","status":"ok"}
```

### 2. å‰ç«¯é¡¹ç›®åˆå§‹åŒ–

#### Reacté¡¹ç›®ç¤ºä¾‹
```bash
npx create-react-app mall-frontend
cd mall-frontend
npm install axios react-router-dom
```

#### Vueé¡¹ç›®ç¤ºä¾‹
```bash
npm create vue@latest mall-frontend
cd mall-frontend
npm install axios vue-router pinia
```

## ğŸ”§ HTTPå®¢æˆ·ç«¯é…ç½®

### Axiosé…ç½® (æ¨è)

```javascript
// src/api/client.js
import axios from 'axios';

// åˆ›å»ºaxioså®ä¾‹
const apiClient = axios.create({
  baseURL: 'http://localhost:8080',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
});

// è¯·æ±‚æ‹¦æˆªå™¨ - è‡ªåŠ¨æ·»åŠ è®¤è¯token
apiClient.interceptors.request.use(
  config => {
    const token = localStorage.getItem('mall_token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  error => Promise.reject(error)
);

// å“åº”æ‹¦æˆªå™¨ - ç»Ÿä¸€é”™è¯¯å¤„ç†
apiClient.interceptors.response.use(
  response => {
    // æ£€æŸ¥ä¸šåŠ¡çŠ¶æ€ç 
    if (response.data.code !== 200) {
      throw new Error(response.data.message || 'è¯·æ±‚å¤±è´¥');
    }
    return response.data;
  },
  error => {
    // å¤„ç†HTTPé”™è¯¯
    if (error.response?.status === 401) {
      // Tokenè¿‡æœŸï¼Œæ¸…é™¤æœ¬åœ°å­˜å‚¨å¹¶è·³è½¬ç™»å½•
      localStorage.removeItem('mall_token');
      localStorage.removeItem('mall_user');
      window.location.href = '/login';
    }
    
    const message = error.response?.data?.message || error.message || 'ç½‘ç»œé”™è¯¯';
    throw new Error(message);
  }
);

export default apiClient;
```

## ğŸ” ç”¨æˆ·è®¤è¯ç®¡ç†

### è®¤è¯çŠ¶æ€ç®¡ç†

```javascript
// src/store/auth.js (Pinia/Vuex/Redux)
import apiClient from '../api/client';

export const useAuthStore = () => {
  const state = {
    user: null,
    token: null,
    isAuthenticated: false
  };

  // ç™»å½•
  const login = async (username, password) => {
    try {
      const response = await apiClient.post('/api/v1/users/login', {
        username,
        password
      });

      const { token, user } = response.data;
      
      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
      localStorage.setItem('mall_token', token);
      localStorage.setItem('mall_user', JSON.stringify(user));
      
      // æ›´æ–°çŠ¶æ€
      state.token = token;
      state.user = user;
      state.isAuthenticated = true;
      
      return { success: true, user };
    } catch (error) {
      return { success: false, message: error.message };
    }
  };

  // æ³¨å†Œ
  const register = async (userData) => {
    try {
      const response = await apiClient.post('/api/v1/users/register', userData);
      return { success: true, data: response.data };
    } catch (error) {
      return { success: false, message: error.message };
    }
  };

  // ç™»å‡º
  const logout = () => {
    localStorage.removeItem('mall_token');
    localStorage.removeItem('mall_user');
    state.token = null;
    state.user = null;
    state.isAuthenticated = false;
  };

  // åˆå§‹åŒ–è®¤è¯çŠ¶æ€
  const initAuth = () => {
    const token = localStorage.getItem('mall_token');
    const user = localStorage.getItem('mall_user');
    
    if (token && user) {
      state.token = token;
      state.user = JSON.parse(user);
      state.isAuthenticated = true;
    }
  };

  return {
    state,
    login,
    register,
    logout,
    initAuth
  };
};
```

### è·¯ç”±å®ˆå«

```javascript
// src/router/guards.js
import { useAuthStore } from '../store/auth';

export const authGuard = (to, from, next) => {
  const authStore = useAuthStore();
  
  // éœ€è¦è®¤è¯çš„è·¯ç”±
  const requiresAuth = to.matched.some(record => record.meta.requiresAuth);
  
  if (requiresAuth && !authStore.state.isAuthenticated) {
    next('/login');
  } else {
    next();
  }
};
```

## ğŸ“¦ APIæœåŠ¡å°è£…

### å•†å“æœåŠ¡

```javascript
// src/api/products.js
import apiClient from './client';

export const productService = {
  // è·å–å•†å“åˆ—è¡¨
  async getProducts(params = {}) {
    const response = await apiClient.get('/api/v1/products', { params });
    return response.data;
  },

  // è·å–å•†å“è¯¦æƒ…
  async getProduct(id) {
    const response = await apiClient.get(`/api/v1/products/${id}`);
    return response.data;
  },

  // è·å–å•†å“åˆ†ç±»
  async getCategories() {
    const response = await apiClient.get('/api/v1/categories');
    return response.data;
  },

  // æœç´¢å•†å“
  async searchProducts(keyword, categoryId = null, page = 1, pageSize = 10) {
    const params = { keyword, page, page_size: pageSize };
    if (categoryId) params.category_id = categoryId;
    
    const response = await apiClient.get('/api/v1/products', { params });
    return response.data;
  }
};
```

### è´­ç‰©è½¦æœåŠ¡

```javascript
// src/api/cart.js
import apiClient from './client';

export const cartService = {
  // è·å–è´­ç‰©è½¦
  async getCart() {
    const response = await apiClient.get('/api/v1/cart');
    return response.data;
  },

  // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
  async addToCart(productId, quantity = 1, skuId = null) {
    const data = { product_id: productId, quantity };
    if (skuId) data.sku_id = skuId;
    
    const response = await apiClient.post('/api/v1/cart/items', data);
    return response.data;
  },

  // æ›´æ–°è´­ç‰©è½¦å•†å“
  async updateCartItem(itemId, quantity, selected = true) {
    const response = await apiClient.put(`/api/v1/cart/items/${itemId}`, {
      quantity,
      selected
    });
    return response.data;
  },

  // åˆ é™¤è´­ç‰©è½¦å•†å“
  async removeCartItem(itemId) {
    const response = await apiClient.delete(`/api/v1/cart/items/${itemId}`);
    return response.data;
  },

  // æ¸…ç©ºè´­ç‰©è½¦
  async clearCart() {
    const response = await apiClient.delete('/api/v1/cart');
    return response.data;
  }
};
```

### è®¢å•æœåŠ¡

```javascript
// src/api/orders.js
import apiClient from './client';

export const orderService = {
  // åˆ›å»ºè®¢å•
  async createOrder(orderData) {
    const response = await apiClient.post('/api/v1/orders', orderData);
    return response.data;
  },

  // è·å–è®¢å•åˆ—è¡¨
  async getOrders(params = {}) {
    const response = await apiClient.get('/api/v1/orders', { params });
    return response.data;
  },

  // è·å–è®¢å•è¯¦æƒ…
  async getOrder(orderId) {
    const response = await apiClient.get(`/api/v1/orders/${orderId}`);
    return response.data;
  },

  // å–æ¶ˆè®¢å•
  async cancelOrder(orderId, reason = '') {
    const response = await apiClient.delete(`/api/v1/orders/${orderId}`, {
      data: { reason }
    });
    return response.data;
  }
};
```

## ğŸ¨ UIç»„ä»¶ç¤ºä¾‹

### å•†å“åˆ—è¡¨ç»„ä»¶

```jsx
// src/components/ProductList.jsx
import React, { useState, useEffect } from 'react';
import { productService } from '../api/products';

const ProductList = ({ categoryId = null }) => {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [pagination, setPagination] = useState({
    page: 1,
    pageSize: 12,
    total: 0
  });

  useEffect(() => {
    loadProducts();
  }, [categoryId, pagination.page]);

  const loadProducts = async () => {
    try {
      setLoading(true);
      const params = {
        page: pagination.page,
        page_size: pagination.pageSize
      };
      if (categoryId) params.category_id = categoryId;

      const data = await productService.getProducts(params);
      setProducts(data.list);
      setPagination(prev => ({
        ...prev,
        total: data.total
      }));
    } catch (error) {
      console.error('åŠ è½½å•†å“å¤±è´¥:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <div>åŠ è½½ä¸­...</div>;

  return (
    <div className="product-list">
      <div className="products-grid">
        {products.map(product => (
          <div key={product.id} className="product-card">
            <img src={product.images?.[0]} alt={product.name} />
            <h3>{product.name}</h3>
            <p className="price">Â¥{product.price}</p>
            <p className="stock">åº“å­˜: {product.stock}</p>
            <button onClick={() => handleAddToCart(product.id)}>
              åŠ å…¥è´­ç‰©è½¦
            </button>
          </div>
        ))}
      </div>
      
      {/* åˆ†é¡µç»„ä»¶ */}
      <Pagination 
        current={pagination.page}
        total={pagination.total}
        pageSize={pagination.pageSize}
        onChange={(page) => setPagination(prev => ({ ...prev, page }))}
      />
    </div>
  );
};
```

### è´­ç‰©è½¦ç»„ä»¶

```jsx
// src/components/Cart.jsx
import React, { useState, useEffect } from 'react';
import { cartService } from '../api/cart';

const Cart = () => {
  const [cart, setCart] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadCart();
  }, []);

  const loadCart = async () => {
    try {
      const data = await cartService.getCart();
      setCart(data);
    } catch (error) {
      console.error('åŠ è½½è´­ç‰©è½¦å¤±è´¥:', error);
    } finally {
      setLoading(false);
    }
  };

  const updateQuantity = async (itemId, quantity) => {
    try {
      await cartService.updateCartItem(itemId, quantity);
      loadCart(); // é‡æ–°åŠ è½½è´­ç‰©è½¦
    } catch (error) {
      console.error('æ›´æ–°æ•°é‡å¤±è´¥:', error);
    }
  };

  const removeItem = async (itemId) => {
    try {
      await cartService.removeCartItem(itemId);
      loadCart(); // é‡æ–°åŠ è½½è´­ç‰©è½¦
    } catch (error) {
      console.error('åˆ é™¤å•†å“å¤±è´¥:', error);
    }
  };

  if (loading) return <div>åŠ è½½ä¸­...</div>;
  if (!cart || !cart.items?.length) return <div>è´­ç‰©è½¦ä¸ºç©º</div>;

  return (
    <div className="cart">
      <h2>è´­ç‰©è½¦</h2>
      <div className="cart-items">
        {cart.items.map(item => (
          <div key={item.id} className="cart-item">
            <img src={item.product_image} alt={item.product_name} />
            <div className="item-info">
              <h4>{item.product_name}</h4>
              <p className="price">Â¥{item.price}</p>
            </div>
            <div className="quantity-controls">
              <button onClick={() => updateQuantity(item.id, item.quantity - 1)}>
                -
              </button>
              <span>{item.quantity}</span>
              <button onClick={() => updateQuantity(item.id, item.quantity + 1)}>
                +
              </button>
            </div>
            <button onClick={() => removeItem(item.id)}>åˆ é™¤</button>
          </div>
        ))}
      </div>
      
      <div className="cart-summary">
        <p>æ€»è®¡: Â¥{cart.total_amount}</p>
        <button onClick={handleCheckout}>å»ç»“ç®—</button>
      </div>
    </div>
  );
};
```

## ğŸ” é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

### å…¨å±€é”™è¯¯å¤„ç†

```javascript
// src/utils/errorHandler.js
export const handleApiError = (error) => {
  console.error('API Error:', error);
  
  // æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒæç¤º
  if (error.message.includes('ç½‘ç»œ')) {
    showNotification('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®', 'error');
  } else if (error.message.includes('ç™»å½•')) {
    showNotification('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•', 'warning');
  } else {
    showNotification(error.message || 'æ“ä½œå¤±è´¥', 'error');
  }
};

// é€šç”¨çš„å¼‚æ­¥æ“ä½œåŒ…è£…å™¨
export const withErrorHandling = async (asyncFn, errorHandler = handleApiError) => {
  try {
    return await asyncFn();
  } catch (error) {
    errorHandler(error);
    throw error;
  }
};
```

## ğŸ“± å“åº”å¼è®¾è®¡å»ºè®®

### ç§»åŠ¨ç«¯é€‚é…

```css
/* src/styles/responsive.css */
.product-grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
}

@media (max-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 0.5rem;
  }
  
  .product-card {
    padding: 0.5rem;
  }
}

@media (max-width: 480px) {
  .product-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å›¾ç‰‡æ‡’åŠ è½½
```jsx
const LazyImage = ({ src, alt, ...props }) => {
  const [loaded, setLoaded] = useState(false);
  const imgRef = useRef();

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setLoaded(true);
          observer.disconnect();
        }
      }
    );

    if (imgRef.current) {
      observer.observe(imgRef.current);
    }

    return () => observer.disconnect();
  }, []);

  return (
    <div ref={imgRef} {...props}>
      {loaded && <img src={src} alt={alt} />}
    </div>
  );
};
```

### 2. æ•°æ®ç¼“å­˜
```javascript
// src/utils/cache.js
const cache = new Map();

export const withCache = (key, asyncFn, ttl = 5 * 60 * 1000) => {
  return async (...args) => {
    const cacheKey = `${key}_${JSON.stringify(args)}`;
    const cached = cache.get(cacheKey);
    
    if (cached && Date.now() - cached.timestamp < ttl) {
      return cached.data;
    }
    
    const data = await asyncFn(...args);
    cache.set(cacheKey, { data, timestamp: Date.now() });
    return data;
  };
};
```

## ğŸ§ª æµ‹è¯•å»ºè®®

### APIæµ‹è¯•
```javascript
// src/api/__tests__/products.test.js
import { productService } from '../products';

describe('Product Service', () => {
  test('should fetch products list', async () => {
    const products = await productService.getProducts();
    expect(products).toHaveProperty('list');
    expect(products.list).toBeInstanceOf(Array);
    expect(products.list.length).toBeGreaterThan(0);
  });

  test('should fetch product detail', async () => {
    const product = await productService.getProduct(1);
    expect(product).toHaveProperty('id', 1);
    expect(product).toHaveProperty('name');
    expect(product).toHaveProperty('price');
  });
});
```

## ğŸ“ è°ƒè¯•æŠ€å·§

### 1. ç½‘ç»œè¯·æ±‚è°ƒè¯•
```javascript
// åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨è¯¦ç»†æ—¥å¿—
if (process.env.NODE_ENV === 'development') {
  apiClient.interceptors.request.use(config => {
    console.log('ğŸš€ Request:', config.method?.toUpperCase(), config.url, config.data);
    return config;
  });

  apiClient.interceptors.response.use(response => {
    console.log('âœ… Response:', response.config.url, response.data);
    return response;
  });
}
```

### 2. çŠ¶æ€è°ƒè¯•
```javascript
// Redux DevTools æˆ– Vue DevTools é›†æˆ
const store = createStore(reducer, 
  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()
);
```

## ğŸ‰ éƒ¨ç½²å»ºè®®

### ç¯å¢ƒå˜é‡é…ç½®
```javascript
// .env.development
REACT_APP_API_BASE_URL=http://localhost:8080

// .env.production  
REACT_APP_API_BASE_URL=https://api.yourdomain.com
```

### æ„å»ºä¼˜åŒ–
```javascript
// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
      },
    },
  },
};
```

---

**Mall-Goå‰ç«¯å¼€å‘æŒ‡å— v1.0**  
**æ›´æ–°æ—¶é—´**: 2024å¹´1æœˆ  
**é€‚ç”¨ç‰ˆæœ¬**: Mall-Go v1.0  
**çŠ¶æ€**: ç”Ÿäº§å°±ç»ª
